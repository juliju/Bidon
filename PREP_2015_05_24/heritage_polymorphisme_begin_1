class Instrument
  def initialize (sonic_pi , synth = :beep)
    @sonic_pi = sonic_pi
    @synth = synth
  end
  

  def play (arrayOfNotes, arrayOfTime)
    @sonic_pi.with_synth @synth do 
      @sonic_pi.play_pattern_timed arrayOfNotes , arrayOfTime
    end
  end 
end


class Saw < Instrument
  def initialize (sonic_pi)
     super(sonic_pi, :saw)
  end
end

class Pulse < Instrument

  def initialize (sonic_pi)
    super(sonic_pi,:pulse)
   # @synth = :pulse
  end
  
  def play (arrayOfNotes, arrayOfTime)
    @sonic_pi.with_transpose 3 do
      super arrayOfNotes , arrayOfTime
    end
  end
  
end

use_bpm 80
base_unit = 2

ronde = base_unit
double = ronde / 2.0
noire = double / 2.0
croche = noire / 2.0
doublecroche = croche / 2.0

demi_soupir = 0.25
soupir = 0.5






chest_music = [:E5,:E5,nil,:E5,nil,:C5,:E5,nil,:G5,nil,nil,nil,:G4,nil]
#chest_music = [:e5,:e5,nil,:e5,nil,:c5,:e5,nil,:g5,nil,nil,nil,nil,nil,nil,nil]
tempo =  [croche]
comment do
  instruments = [Instrument.new(self), Saw.new(self), Pulse.new(self)]
  instruments.each do |i|
    # i.play([:fs4,:e4,:d4,:cs4,:b3,:a3,:b3,:cs4,:d4,:cs4,:b3,:a3,:g3,:fs3,:g3,:a3], [1])
    i.play(chest_music,tempo)
    sleep 2
  end
end

class PlayInstrument

  def initialize (sonic_pi)
    @sonic_pi = sonic_pi
  end

  def play (notes, tempo)
    @sonic_pi.play_pattern_timed notes, tempo
  end


  def prout(notes, tempo, synth=:beep)
     @sonic_pi.with_synth synth do
      @sonic_pi.play_pattern_timed notes, tempo 

    end
  end

  def playPulse(notes, tempo)
    @sonic_pi.with_synth :pulse_s do
      @sonic_pi.play_pattern_timed notes, tempo 
    end
  end

  def playSaw(notes, tempo)
    @sonic_pi.with_synth :saw do
      play notes, tempo
    end
  end
end


comment do
instrument = PlayInstrument.new(self)
instrument.prout(chest_music, tempo)
sleep 1
instrument.prout(chest_music, tempo, :pulse)
      sleep 1
instrument.prout(chest_music, tempo, :saw)
#instrument.playPulse(chest_music, tempo)
sleep 1
#instrument.playSaw(chest_music, tempo)
end